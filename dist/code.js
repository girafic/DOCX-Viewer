!function(e){var i={};function t(n){if(i[n])return i[n].exports;var a=i[n]={i:n,l:!1,exports:{}};return e[n].call(a.exports,a,a.exports,t),a.l=!0,a.exports}t.m=e,t.c=i,t.d=function(e,i,n){t.o(e,i)||Object.defineProperty(e,i,{enumerable:!0,get:n})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,i){if(1&i&&(e=t(e)),8&i)return e;if(4&i&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(t.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&i&&"string"!=typeof e)for(var a in e)t.d(n,a,function(i){return e[i]}.bind(null,a));return n},t.n=function(e){var i=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(i,"a",i),i},t.o=function(e,i){return Object.prototype.hasOwnProperty.call(e,i)},t.p="",t(t.s=193)}({193:function(e,i){var t=this&&this.__awaiter||function(e,i,t,n){return new(t||(t=Promise))((function(a,r){function o(e){try{s(n.next(e))}catch(e){r(e)}}function c(e){try{s(n.throw(e))}catch(e){r(e)}}function s(e){var i;e.done?a(e.value):(i=e.value,i instanceof t?i:new t((function(e){e(i)}))).then(o,c)}s((n=n.apply(e,i||[])).next())}))};const n=["VECTOR","STAR","ELLIPSE","POLYGON","RECTANGLE","TEXT"],a=["FRAME","GROUP","COMPONENT"];figma.clientStorage.getAsync("docxViewerLastedOpenFile").then(e=>{figma.showUI(__html__,{width:800,height:500}),figma.ui.postMessage({type:"loadDocx",resultValue:e})}),figma.ui.onmessage=e=>t(this,void 0,void 0,(function*(){if("change-window-size"===e.type)switch(e.rate){case"800x500":figma.ui.resize(800,500);break;case"500x800":figma.ui.resize(500,800);break;case"800x800":figma.ui.resize(800,800);break;case"500x500":figma.ui.resize(500,500);break;case"360x500":figma.ui.resize(360,500);break;case"360x800":figma.ui.resize(360,800);break;case"500x360":figma.ui.resize(500,360);break;case"360x360":figma.ui.resize(360,360);break;case"800xMaxWindow":figma.ui.resize(800,e.h)}else if("placeImage"===e.type)try{let i=yield e.image,t={type:"IMAGE",imageHash:figma.createImage(i).hash,scaleMode:"FILL"},r=figma.currentPage,o=figma.currentPage.selection[0],c=figma.createRectangle(),s=e.dimensions.width,f=e.dimensions.height;c.name="image "+s+"x"+f,c.resize(s,f),c.x=figma.viewport.center.x-Math.round(s/2),c.y=figma.viewport.center.y-Math.round(f/2),c.fills=[t],(()=>{const e=figma.currentPage.selection;return e.length>0&&a.includes(e[0].type)})()&&(r=o,c.x=r.width/2-Math.round(s/2)+("FRAME"!==(null==o?void 0:o.type)?o.x:0),c.y=r.height/2-Math.round(f/2)+("FRAME"!==(null==o?void 0:o.type)?o.y:0)),(()=>{const e=figma.currentPage.selection;return e.length>0&&n.includes(e[0].type)})()?(o.fills=[t],c&&!c.removed&&c.remove(),figma.currentPage.selection=[o],figma.viewport.scrollAndZoomIntoView([o])):(r.appendChild(c),figma.currentPage.selection=[c],figma.viewport.scrollAndZoomIntoView([c]))}catch(e){figma.notify(e.message)}else if("saveDocx"===e.type)try{yield figma.clientStorage.setAsync("docxViewerLastedOpenFile",JSON.stringify(e.resultValue)),figma.notify("üíæ File saved in cache")}catch(e){yield figma.clientStorage.setAsync("docxViewerLastedOpenFile",""),figma.notify("‚ö†Ô∏è File too big for saving in cache.")}else if("clearCache"===e.type)try{yield figma.clientStorage.setAsync("docxViewerLastedOpenFile",""),figma.notify("Cache cleared!")}catch(e){}}))}});